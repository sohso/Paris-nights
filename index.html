<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Midnight 2026</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;1,400&display=swap');

        body { margin: 0; overflow: hidden; background-color: #000; font-family: 'Playfair Display', serif; touch-action: none; }
        canvas { display: block; }
        
        #ui-layer {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: white;
            pointer-events: none;
            z-index: 10;
            width: 90%;
        }

        .message-line {
            opacity: 0;
            transition: opacity 2.5s ease-in-out;
            margin-bottom: 12px;
            display: block;
            font-size: clamp(1rem, 4.5vw, 1.4rem);
            font-style: italic;
            text-shadow: 0 2px 10px rgba(0,0,0,1);
        }

        #collage-container {
            position: absolute;
            top: 45%; left: 50%;
            transform: translate(-50%, -50%);
            width: 95vw;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 10px;
            opacity: 0;
            transition: opacity 3s ease-in-out;
            z-index: 20;
            pointer-events: none;
        }

        .collage-img {
            width: 30%;
            aspect-ratio: 1/1;
            border: 2px solid #fff;
            border-radius: 8px;
            object-fit: cover;
            transform: rotate(var(--r));
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            background: #111;
        }

        #kiss-text {
            position: fixed;
            bottom: 12%; 
            left: 0;
            width: 100%;
            text-align: center;
            font-size: clamp(1.8rem, 8vw, 2.5rem);
            color: #ff4d6d;
            text-shadow: 0 0 20px rgba(255,77,109,0.8);
            opacity: 0;
            transition: opacity 3s ease-in-out;
            z-index: 25;
            font-weight: bold;
        }

        .visible { opacity: 1 !important; }
    </style>
</head>
<body>

<div id="ui-layer">
    <div id="message-container">
        <span class="message-line">The world is loud, but itâ€™s always quiet with you.</span>
        <span class="message-line">Iâ€™m so grateful for every day we spent side by side.</span>
        <span class="message-line">Thank you for being my constant, my peace, and my home.</span>
        <span class="message-line">I love you.</span>
        <span class="message-line">I don't need a resolution... I just need you.</span>
    </div>
</div>

<div id="collage-container">
    <img src="https://i.postimg.cc/nzYSG7qb/IMG-20251231-233613.jpg" class="collage-img" style="--r: -5deg;">
    <img src="https://i.postimg.cc/k4FYv8WP/IMG-20251231-234529.jpg" class="collage-img" style="--r: 3deg;">
    <img src="https://i.postimg.cc/bJjFnLDL/Screenshot_2025_12_31_23_45_42_875_com_miui_mediaviewer_edit.jpg" class="collage-img" style="--r: -2deg;">
    <img src="https://i.postimg.cc/4db2QtVW/Screenshot_2025_12_31_23_45_57_037_com_miui_mediaviewer_edit.jpg" class="collage-img" style="--r: 6deg;">
    <img src="https://i.postimg.cc/vBL2t9fJ/Screenshot_2025_12_31_23_46_15_745_com_miui_mediaviewer_edit.jpg" class="collage-img" style="--r: -4deg;">
</div>
<div id="kiss-text">ðŸ’‹ Happy New Year! ðŸ’‹</div>

<script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
</script>

<script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.set(0, 0, 15);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    document.body.appendChild(renderer.domElement);

    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.enableZoom = false;
    controls.autoRotate = true;
    controls.autoRotateSpeed = 0.5;

    // --- STARS ---
    const starGeo = new THREE.BufferGeometry();
    const starPos = new Float32Array(8000 * 3);
    for (let i = 0; i < 8000 * 3; i++) starPos[i] = (Math.random() - 0.5) * 1000;
    starGeo.setAttribute('position', new THREE.BufferAttribute(starPos, 3));
    scene.add(new THREE.Points(starGeo, new THREE.PointsMaterial({ color: 0xffffff, size: 0.7 })));

    const particles = [];
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = 256; canvas.height = 256;

    function createFireworkNumber(num) {
        ctx.clearRect(0, 0, 256, 256);
        ctx.fillStyle = "white";
        ctx.font = "bold 180px Arial";
        ctx.textAlign = "center";
        ctx.fillText(num, 128, 175);
        
        const imgData = ctx.getImageData(0, 0, 256, 256).data;
        const geo = new THREE.BufferGeometry();
        const pos = [];
        const vels = [];
        for (let y = 0; y < 256; y += 5) {
            for (let x = 0; x < 256; x += 5) {
                if (imgData[(y * 256 + x) * 4 + 3] > 128) {
                    pos.push((x - 128) * 0.1, (128 - y) * 0.1, 0);
                    vels.push((Math.random()-0.5)*0.1, (Math.random()-0.5)*0.1, (Math.random()-0.5)*0.1);
                }
            }
        }
        geo.setAttribute('position', new THREE.Float32BufferAttribute(pos, 3));
        const mat = new THREE.PointsMaterial({ size: 0.3, color: 0xffcc33, transparent: true, blending: THREE.AdditiveBlending });
        const points = new THREE.Points(geo, mat);
        points.lookAt(camera.position);
        scene.add(points);
        particles.push({ points, vels, life: 1.6 });
    }

    const fireworks = [];
    function createNormalFirework() {
        const pCount = 100;
        const geo = new THREE.BufferGeometry();
        const pos = new Float32Array(pCount * 3);
        const vels = [];
        const color = new THREE.Color().setHSL(Math.random(), 0.8, 0.6);
        const origin = new THREE.Vector3().setFromSphericalCoords(45, Math.random()*Math.PI, Math.random()*Math.PI*2);
        for(let i=0; i<pCount; i++) {
            pos[i*3]=origin.x; pos[i*3+1]=origin.y; pos[i*3+2]=origin.z;
            vels.push(new THREE.Vector3((Math.random()-0.5)*0.6, (Math.random()-0.5)*0.6, (Math.random()-0.5)*0.6));
        }
        geo.setAttribute('position', new THREE.BufferAttribute(pos, 3));
        scene.add(new THREE.Points(geo, new THREE.PointsMaterial({ size: 0.4, color: color, transparent: true, blending: THREE.AdditiveBlending })));
    }

    let count = 10;
    const timer = setInterval(() => {
        if (count > 0) { createFireworkNumber(count); count--; }
        else { clearInterval(timer); startCelebration(); }
    }, 1100);

    function startCelebration() {
        setInterval(createNormalFirework, 600);
        const lines = document.querySelectorAll('.message-line');
        lines.forEach((l, i) => setTimeout(() => l.classList.add('visible'), i * 3500));
        
        setTimeout(() => {
            document.getElementById('message-container').style.opacity = "0";
            setTimeout(() => {
                document.getElementById('collage-container').classList.add('visible');
                document.getElementById('kiss-text').classList.add('visible');
            }, 2000);
        }, lines.length * 4000);
    }

    function animate() {
        requestAnimationFrame(animate);
        controls.update();
        particles.forEach((p, idx) => {
            p.life -= 0.01;
            const pArr = p.points.geometry.attributes.position.array;
            for(let i=0; i<p.vels.length; i++) {
                pArr[i*3]+=p.vels[i*3]; pArr[i*3+1]+=p.vels[i*3+1]; pArr[i*3+2]+=p.vels[i*3+2];
            }
            p.points.geometry.attributes.position.needsUpdate = true;
            p.points.material.opacity = p.life;
            if(p.life <= 0) { scene.remove(p.points); particles.splice(idx, 1); }
        });
        renderer.render(scene, camera);
    }
    animate();
    window.onresize = () => { camera.aspect = window.innerWidth/window.innerHeight; camera.updateProjectionMatrix(); renderer.setSize(window.innerWidth, window.innerHeight); };
</script>
</body>
</html>
